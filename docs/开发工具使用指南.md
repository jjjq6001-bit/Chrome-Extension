# HBSY VideoGrabber Pro - 开发工具使用指南

本文档介绍项目中各种开发工具和脚本的使用方法。

---

## 目录

1. [项目构建](#1-项目构建)
2. [自动化打包发布](#2-自动化打包发布)
3. [推广文案生成](#3-推广文案生成)
4. [图标生成](#4-图标生成)
5. [宣传图生成](#5-宣传图生成)
6. [GitHub Actions 自动发布](#6-github-actions-自动发布)
7. [国际化 (i18n)](#7-国际化-i18n)

---

## 1. 项目构建

### 安装依赖

```bash
cd VideoGrabber
npm install
```

### 开发模式

```bash
npm run dev
```

### 生产构建

```bash
npm run build
```

构建输出目录：`dist/`

### 加载到 Chrome 测试

1. 打开 Chrome，访问 `chrome://extensions/`
2. 开启「开发者模式」
3. 点击「加载已解压的扩展程序」
4. 选择 `dist` 文件夹

---

## 2. 自动化打包发布

### 脚本位置

`build_release.py`

### 功能

- 读取 `manifest.json` 版本号
- 生成源码包 (排除开发文件)
- 生成安装包 (用户安装用)
- 生成中英文更新日志模板

### 使用方法

```bash
# 先构建项目
npm run build

# 运行打包脚本
python build_release.py
```

### 输出文件

```
release/
├── HBSY_VideoGrabber_Pro_v{version}_Source.zip   # 源码包
├── HBSY_VideoGrabber_Pro_v{version}_Install.zip  # 安装包
├── release_note_zh.txt                            # 中文更新日志
└── release_note_en.txt                            # 英文更新日志
```

---

## 3. 推广文案生成

### 脚本位置

`scripts/generate_promo.js`

### 功能

生成三种不同风格的推广文案：

| 模板 | 风格 | 适用平台 |
|------|------|----------|
| A | 极客风 | GitHub, Reddit, Hacker News |
| B | 亲民风 | 吾爱破解, 52pojie, 贴吧 |
| C | 官方风 | 软件下载站, 官网 |

### 使用方法

```bash
# 使用模板生成
node scripts/generate_promo.js

# 使用 AI 生成 (需要 OpenAI API Key)
# Windows PowerShell
$env:OPENAI_API_KEY="sk-xxx"; node scripts/generate_promo.js --ai

# macOS/Linux
OPENAI_API_KEY=sk-xxx node scripts/generate_promo.js --ai
```

### 输出文件

```
promo/
├── promo_github_reddit.md  # GitHub/Reddit 极客风 (英文)
├── promo_cn_forum.md       # 国内论坛亲民风 (中文)
└── promo_official.md       # 通用下载站官方风 (中文)
```

---

## 4. 图标生成

### 脚本位置

`scripts/generate-icons.js`

### 功能

生成 Chrome 扩展所需的各尺寸图标 (16x16, 48x48, 128x128)

### 使用方法

```bash
node scripts/generate-icons.js
```

### 输出文件

```
public/icons/
├── icon16.png
├── icon48.png
└── icon128.png
```

---

## 5. 宣传图生成

### 脚本位置

`scripts/generate-promo.js`

### 功能

生成 Chrome Web Store 所需的宣传图

### 使用方法

```bash
node scripts/generate-promo.js
```

### 输出文件

```
store-assets/
├── promo-small-440x280.png    # 小宣传图
├── promo-large-1400x560.png   # 大宣传图
└── screenshot-bg-1280x800.png # 截图背景
```

---

## 6. GitHub Actions 自动发布

### 配置文件

- `.github/workflows/release.yml` - 基础版
- `.github/workflows/release-with-ai.yml` - AI 增强版

### 触发条件

推送以 `v` 开头的标签

### 使用方法

```bash
# 1. 提交代码
git add .
git commit -m "feat: 新功能描述"

# 2. 创建版本标签
git tag v1.0.0

# 3. 推送标签 (触发自动发布)
git push origin v1.0.0
# 或推送所有标签
git push --tags
```

### 自动执行的任务

1. ✅ 检出代码
2. ✅ 安装依赖 (`npm ci`)
3. ✅ 构建扩展 (`npm run build`)
4. ✅ 运行打包脚本 (`build_release.py`)
5. ✅ 生成 Release Notes
6. ✅ 创建 GitHub Release
7. ✅ 上传 ZIP 包

### AI 功能配置 (可选)

1. 获取 [OpenAI API Key](https://platform.openai.com/api-keys)
2. 在 GitHub 仓库 → Settings → Secrets → Actions
3. 添加 Secret: `OPENAI_API_KEY`

---

## 7. 国际化 (i18n)

### 文件结构

```
public/_locales/
├── en/
│   └── messages.json    # 英文翻译
└── zh_CN/
    └── messages.json    # 中文翻译
```

### 在代码中使用

```typescript
import { i18n } from '../utils/i18n';

// 简单消息
i18n.appTitle()      // 根据浏览器语言返回中文或英文

// 带参数的消息
i18n.videosFound(3)  // "检测到 3 个视频" 或 "Found 3 video(s)"
```

### 添加新的翻译

1. 在 `public/_locales/zh_CN/messages.json` 添加中文
2. 在 `public/_locales/en/messages.json` 添加英文
3. 在 `src/utils/i18n.ts` 添加快捷方法

### 消息格式

```json
{
  "messageName": {
    "message": "显示的文本",
    "description": "描述（给翻译者看）",
    "placeholders": {
      "count": {
        "content": "$1",
        "example": "3"
      }
    }
  }
}
```

---

## 快速参考

| 任务 | 命令 |
|------|------|
| 安装依赖 | `npm install` |
| 开发模式 | `npm run dev` |
| 生产构建 | `npm run build` |
| 打包发布 | `python build_release.py` |
| 生成文案 | `node scripts/generate_promo.js` |
| 生成图标 | `node scripts/generate-icons.js` |
| 生成宣传图 | `node scripts/generate-promo.js` |
| 创建版本 | `git tag v1.0.0 && git push --tags` |

---

## 常见问题

### Q: 构建失败怎么办？

```bash
# 清除缓存重新安装
rm -rf node_modules
npm install
npm run build
```

### Q: 如何更新版本号？

修改 `manifest.json` 中的 `version` 字段，然后重新构建。

### Q: 如何添加新语言支持？

1. 在 `public/_locales/` 下创建新语言文件夹（如 `ja` 日语）
2. 复制 `en/messages.json` 并翻译
3. 重新构建

---

*最后更新: 2024-12-12*
